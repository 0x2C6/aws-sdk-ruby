script: bundle exec rake
bundler_args: --without bin docs
branches:
  only:
  - master

rvm:
- 1.9.3
- 2.0.0
- 2.1.2
- jruby

env:
- PURE_RUBY=1
- NOKOGIRI=1
- OX=1 OJ=1

gemfile:
- Gemfile

matrix:
  exclude:
  - rvm: jruby
    env: OX=1 OJ=1
    gemfile: Gemfile

deploy:

  - provider: rubygems
    gemspec: aws-sdk-core.gemspec
    api_key:
      secure: "MAZhh9g7Kq40scij2aVIz/Jz1h1FPXbguRj6Q97wfajywVHhWZpnsRKgcvUSnw7UiqoFfxEN0YO99bjVTXguA3IkEvcn9XAvp0JMJBnfoQu+weXvWglTsbVD25JeG+ZH3qsa6IDp0pzWUyDa1dIlBtXc5sYbVpODyGmsrANoKZE="
    on:
      repo: aws/aws-sdk-core-ruby
      branch: master
      tags: true

  - provider: releases
    api_key:
      secure: iP6CzsFh6CcUtVFcvn/s9hphzHsVw4lL/CpwAxJUeHiVU/g9529BhBLr271wVC4xCoZeuRnbE6MWKaveyzBYFitLj2tmUY7O6SqYHUjgusG2YqkRefZK10pfgFYyePOc6z7OiZQSeZj1abiRWjGHh9GewFGgAQzmzSaeEE2VomI=
    file: api-docs.tgz
    on:
      repo: aws/aws-sdk-core-ruby
      branch: master
      tags: true
